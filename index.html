<html>

<body>
  <script src='https://static.line-scdn.net/liff/edge/2/sdk.js'></script>
  <script>
    async function getFriendship() {
      const friend = await liff.getFriendship()
      const queryString = decodeURIComponent(window.location.search);
      const item = new URLSearchParams(queryString);
      const param = item.get('item')
      const redirectUrl = 'https://www.royalchitraladaprojects.org/'
      const lineId = '@405cnjlw'
      const liffInfo = '2004757243-36584QdN'

      if (friend.friendFlag) {
        window.location = redirectUrl + param
      } else {
        if (confirm('กรุณาเพิ่มเพื่อน LINE Official Account ก่อนเพื่อดำเนินการต่อไป')) {
          window.location = 'https://line.me/R/ti/p/' + lineId
        } else {
          liff.closeWindow()
        }
      }
    }

    async function main() {
      liff.ready.then(() => {
        if (liff.isLoggedIn()) {
          getFriendship()
        } else {
          liff.login()
        }
      });
      await liff.init({ liffId: liffInfo })
    }
    main()
  </script>
</body>

</html>